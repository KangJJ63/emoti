<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main Page</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Jua&family=Nanum+Myeongjo:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Gowun+Batang&family=Jua&family=Nanum+Myeongjo:wght@400;700&display=swap" rel="stylesheet">       

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>
<body>
    <!-- HTML 코드 -->
    <div class="logo">Emoti</div>
    <header>
        <div class="logo">Emoti</div>
        <nav>
    
            <!-- 로그인과 내 정보 버튼을 추가하고 오른쪽으로 배치합니다. -->            
            <button class="btn my-account-btn" onclick="openPopup()">로그인</button>
            <div class="popup" id="popup">
                <iframe id="popupFrame" src="" frameborder="0" style="width: 100%; height: 100%;"></iframe>
                
            </div>
            <div class="overlay" id="overlay" onclick="closePopup()"></div>
            <script>
                var currentPopup = null;
            
                // function openPopup() {
                //     var popup = document.getElementById("popup");
                //     var overlay = document.getElementById("overlay");
                //     popup.style.display = "block";
                //     overlay.style.display = "block";
                //     currentPopup = popup;

                //     document.getElementById("popupFrame").src = "/loginPage"; // 두 번째 HTML 페이지를 로드
                // }
                
                function openPopup() {
                var popup = document.getElementById("popup");
                var overlay = document.getElementById("overlay");
                popup.style.display = "block";
                overlay.style.display = "block";
                currentPopup = popup;
                
                // Ajax 호출을 통해 loginPage를 로드
                $.ajax({
                    url: "/loginPage",
                    method: "GET",
                    success: function(response) {
                        // loginPage 내용을 팝업 iframe에 삽입
                        document.getElementById("popupFrame").srcdoc = response
                    },
                    error: function(xhr, status, error) {
                        console.error("Error loading loginPage:", error);
                        // 에러 처리
                    }
                });
            }

            
                function closePopup() {
                    var popup = document.getElementById("popup");
                    var overlay = document.getElementById("overlay");
                    popup.style.display = "none";
                    overlay.style.display = "none";
                    currentPopup = null;
                }
            </script>
            <button class="btn my-account-btn">My Page</button>
        </nav>
    </header>


    <section id="section5">
        <br><br>
        <h2>"나는 나의 한계를 안다.<br> 그것이 내가 그 너머로 가는 이유다"</h2>
        <br>
        <p1>-세르주 갱스부르-</p1>
        <br><br>
    </section>
    
    <section id="section1">
        <br><br><br>
        <h2>우리의 기분</h2>
        <p>오늘 우리는 맑음^^</p>
        <br><br>
        <img src="/static/img/smile.png" alt="기쁨" style="width: 200px;">
        <br><br><br>
    </section>

    

    <section id="section2">
        <br><br><br>
        <h2>오늘 나의 기분</h2>
        <p>오늘은 기분이 어떠신가요?</p>
        <br><br>
        <div class="image-container">
            <figure  onclick="showCaption('행복')">
                <img src="/static/img/행복.png" alt="이미지 1" style="width: 100px; height: auto;">
                <figcaption>행복</figcaption>
            </figure>
            <figure>
                <img src="/static/img/평온.png" alt="이미지 2" style="width: 100px; height: auto;">
                <figcaption>평온</figcaption>
            </figure>
            <figure>
                <img src="/static/img/놀람.png" alt="이미지 3" style="width: 100px; height: auto;">
                <figcaption>놀람</figcaption>
            </figure>
            <figure>
                <img src="/static/img/슬픔.png" alt="이미지 4" style="width: 100px; height: auto;">
                <figcaption>슬픔</figcaption>
            </figure>
            <figure>
                <img src="/static/img/화남.png" alt="이미지 5" style="width: 100px; height: auto;">
                <figcaption>화남</figcaption>
            </figure>
        </div>
        
        <br><br><br>
    </section>
    <script>
        function showCaption(caption) {
            alert(caption);
        }
    </script>
    

    <section id="section3">
        <br><br><br>
        <h2>내 기분이 왜 이럴까?</h2>
        <p>혹시 내 기분에 영향을 미친 일들은 없을까요?</p>
        <br><br>
        
        <div class="sub-section-container">
            <div class="sub-section">
                <p>날씨</p>
                <br>
                <img src="/static/img/smile.png" alt="이미지 1" style="width: 80px;">
                <p>맑음</p>
            </div>
            
            <div class="sub-section">
                <p>날씨</p>
                <br>
                <img src="/static/img/smile.png" alt="이미지 1" style="width: 80px;">
                <p>맑음</p>
            </div>
            
            <div class="sub-section">
                <p>날씨</p>
                <br>
                <img src="/static/img/smile.png" alt="이미지 1" style="width: 80px;">
                <p>맑음</p>
            </div>
        </div>
        <br><br><br>
    </section>
    
    
    
    
    

    <section id="section4">
        <br><br><br>
        <h2>와글와글 떠듭시당</h2>
        <br>
        <form class="comment-form" action="#" method="post">
            <textarea name="comment" placeholder="와글와글 떠들어주세요!(500자까지만!)" maxlength="500" required></textarea><br>
            <input type="submit" value="와글와글">
        </form>
        <br><br><br>
        <div class="comment-list">
            <h2>왁자지껄</h2>
            <div class="comments"></div>
            <div class="pagination"></div>
        </div>
    </div>
    
    <script>
    // 댓글 데이터 (예시)
    const comments = [
        { author: "작성자1", content: "이것은 첫 번째 댓글입니다." },
        { author: "작성자2", content: "두 번째 댓글은 어떨까요?" },
        { author: "작성자3", content: "세 번째 댓글도 추가해보겠습니다." },
        { author: "작성자1", content: "이것은 첫 번째 댓글입니다." },
        { author: "작성자2", content: "두 번째 댓글은 어떨까요?" },
        { author: "작성자3", content: "세 번째 댓글도 추가해보겠습니다." },
        { author: "작성자1", content: "이것은 첫 번째 댓글입니다." },
        { author: "작성자2", content: "두 번째 댓글은 어떨까요?" },
        { author: "작성자3", content: "세 번째 댓글도 추가해보겠습니다." },
        { author: "작성자1", content: "이것은 첫 번째 댓글입니다." },
        { author: "작성자2", content: "두 번째 댓글은 어떨까요?" },
        { author: "작성자3", content: "세 번째 댓글도 추가해보겠습니다." },
        // 추가 댓글 데이터
    ];
    
    const commentsPerPage = 5; // 한 페이지에 보일 댓글 수
    let currentPage = 1; // 현재 페이지
    
    

// 수정 기능
function editComment(index) {
    const commentElement = document.querySelector('.comment:nth-child(' + (index + 1) + ')');
    
    // 이미 수정 폼이 열려 있는지 확인
    if (commentElement.querySelector('.edit-form')) {
        return; // 수정 폼이 이미 열려있으면 더 이상 처리하지 않음
    }
    
    const commentContent = commentElement.querySelector('.comment-content');
    const originalContent = commentContent.querySelector('p').textContent;

    // 원래 내용 보이기
    commentContent.style.display = 'block';

    // 수정 폼 추가
    const editForm = document.createElement('div');
    editForm.classList.add('edit-form');
    editForm.innerHTML = `
        <textarea class="edit-content" maxlength="500">${originalContent}</textarea>
        <div class="button-container">
            <button onclick="saveEdit(${index})">저장</button>
            <button onclick="cancelEdit(${index})">취소</button>
        </div>
    `;
    commentElement.appendChild(editForm);
}

// 저장 기능
function saveEdit(index) {
    const editedContent = document.querySelector('.comment:nth-child(' + (index + 1) + ') .edit-content').value;
    comments[index].content = editedContent;

    // 수정 완료 후 수정 폼 제거
    const commentElement = document.querySelector('.comment:nth-child(' + (index + 1) + ')');
    commentElement.removeChild(commentElement.querySelector('.edit-form'));

    // 다시 댓글 표시
    displayComments();
}

// 취소 기능
function cancelEdit(index) {
    const commentElement = document.querySelector('.comment:nth-child(' + (index + 1) + ')');
    // 수정 폼 제거
    commentElement.removeChild(commentElement.querySelector('.edit-form'));
    
    // 원래 내용 보이기
    commentElement.querySelector('.comment-content').style.display = 'block';
}




// 삭제 기능
function deleteComment(index) {
    const confirmation = confirm("정말로 이 댓글을 삭제하시겠습니까?");
    if (confirmation) {
        comments.splice(index, 1);
        displayComments();
    }
}

// 댓글 목록 및 페이지 링크를 표시하는 함수
function displayComments() {
    const commentList = document.querySelector('.comments');
    const pagination = document.querySelector('.pagination');

    commentList.innerHTML = '';
    pagination.innerHTML = '';

    const startIndex = (currentPage - 1) * commentsPerPage;
    const endIndex = startIndex + commentsPerPage;
    const displayedComments = comments.slice(startIndex, endIndex);

    displayedComments.forEach((comment, index) => {
        const commentElement = document.createElement('div');
        commentElement.classList.add('comment');
        commentElement.innerHTML = `
            <div class="comment-content">
                <p><span class="comment-author">${comment.author}:</span> ${comment.content}</p>
            </div>
            <div class="comment-buttons">
                <button onclick="editComment(${startIndex + index})">수정</button>
                <button onclick="deleteComment(${startIndex + index})">삭제</button>
            </div>
        `;
        commentList.appendChild(commentElement);
    });

    const totalPages = Math.ceil(comments.length / commentsPerPage);
    for (let i = 1; i <= totalPages; i++) {
        const pageLink = document.createElement('a');
        pageLink.classList.add('page-link');
        pageLink.textContent = i;
        pageLink.addEventListener('click', () => {
            currentPage = i;
            displayComments();
        });
        pagination.appendChild(pageLink);
    }
}

// 페이지 로드 시 댓글 표시
displayComments();

    </script>
    <br><br><br>
    </section>   
</body>
</html>
<
